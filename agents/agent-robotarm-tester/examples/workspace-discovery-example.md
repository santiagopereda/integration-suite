# Example: Complete Workspace Boundary Discovery

This example demonstrates a comprehensive workspace boundary discovery workflow generated by agent-robotarm-tester.

## Scenario

**User Request:**
```
@agent-robotarm-tester: I just set up my robot arm (model XR-5000) on
Raspberry Pi hostname "robotarm-pi". I don't know the workspace limits yet.
Create a complete boundary discovery workflow for all three axes (X, Y, Z).

Command syntax:
- Home: robot-cli home
- Move: robot-cli move [axis] [value]
- Status: robot-cli status
- Position: robot-cli position
```

## Agent Output

### Pre-Test Safety Verification

Before beginning workspace discovery, verify your environment:

**Safety Checklist:**
- [ ] Robot arm is securely mounted to stable surface
- [ ] Test area is clear of obstacles and people
- [ ] Emergency stop is accessible and functional
- [ ] You can physically reach robot during testing
- [ ] SSH connection to robotarm-pi is working
- [ ] Robot responds to home command

**Verify SSH Access:**
```bash
ssh pi@robotarm-pi "robot-cli status"
```

Expected: Status output with current position information. If this fails, troubleshoot SSH connectivity before proceeding.

---

### Phase 1: X-Axis Boundary Discovery

**Objective:** Discover minimum and maximum X-axis limits safely through progressive testing.

**Test Sequence:**

```bash
#!/bin/bash
# X-Axis Workspace Discovery
# Generated: 2025-12-06 14:30:00
# Robot: XR-5000 on robotarm-pi

LOG_FILE="workspace-discovery-x-axis-$(date +%Y%m%d-%H%M%S).log"

echo "=== X-Axis Workspace Discovery Started ===" | tee -a "$LOG_FILE"
echo "Start time: $(date -Iseconds)" | tee -a "$LOG_FILE"

# Step 1: Return to home position
echo "" | tee -a "$LOG_FILE"
echo "Step 1: Returning to home position" | tee -a "$LOG_FILE"
ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"

if [ $? -ne 0 ]; then
  echo "ERROR: Failed to reach home position. Aborting test." | tee -a "$LOG_FILE"
  exit 1
fi

ssh pi@robotarm-pi "robot-cli status" 2>&1 | tee -a "$LOG_FILE"
echo "Home position verified successfully" | tee -a "$LOG_FILE"

# Step 2: Test X-axis positive direction
echo "" | tee -a "$LOG_FILE"
echo "Step 2: Testing X-axis POSITIVE direction" | tee -a "$LOG_FILE"

X_POSITIVE_LIMIT=0
for distance in 10 20 50 100 150 200 250 300; do
  echo "  Testing X = +$distance mm..." | tee -a "$LOG_FILE"

  ssh pi@robotarm-pi "robot-cli move x $distance" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    echo "  LIMIT REACHED: X-axis positive limit detected at approximately +$distance mm" | tee -a "$LOG_FILE"
    X_POSITIVE_LIMIT=$((distance - 10))  # Previous successful position
    echo "  Setting safe positive limit to +$X_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"

    # Return to home after limit detection
    echo "  Returning to home position..." | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  # Verify position
  position=$(ssh pi@robotarm-pi "robot-cli position" 2>&1)
  echo "  Current position: $position" | tee -a "$LOG_FILE"

  # Record successful position
  X_POSITIVE_LIMIT=$distance

  # Return to home before next test
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

echo "" | tee -a "$LOG_FILE"
echo "X-axis positive limit discovered: +$X_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"

# Step 3: Test X-axis negative direction
echo "" | tee -a "$LOG_FILE"
echo "Step 3: Testing X-axis NEGATIVE direction" | tee -a "$LOG_FILE"

X_NEGATIVE_LIMIT=0
for distance in -10 -20 -50 -100 -150 -200 -250 -300; do
  echo "  Testing X = $distance mm..." | tee -a "$LOG_FILE"

  ssh pi@robotarm-pi "robot-cli move x $distance" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    echo "  LIMIT REACHED: X-axis negative limit detected at approximately $distance mm" | tee -a "$LOG_FILE"
    X_NEGATIVE_LIMIT=$((distance + 10))  # Previous successful position
    echo "  Setting safe negative limit to $X_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"

    # Return to home after limit detection
    echo "  Returning to home position..." | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  # Verify position
  position=$(ssh pi@robotarm-pi "robot-cli position" 2>&1)
  echo "  Current position: $position" | tee -a "$LOG_FILE"

  # Record successful position
  X_NEGATIVE_LIMIT=$distance

  # Return to home before next test
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

echo "" | tee -a "$LOG_FILE"
echo "X-axis negative limit discovered: $X_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"

# Summary
echo "" | tee -a "$LOG_FILE"
echo "=== X-Axis Discovery Complete ===" | tee -a "$LOG_FILE"
echo "Positive limit: +$X_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Negative limit: $X_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Total X-axis range: $((X_POSITIVE_LIMIT - X_NEGATIVE_LIMIT)) mm" | tee -a "$LOG_FILE"
echo "End time: $(date -Iseconds)" | tee -a "$LOG_FILE"
```

**Expected Output:**
```
=== X-Axis Workspace Discovery Started ===
Start time: 2025-12-06T14:30:00-05:00

Step 1: Returning to home position
[Robot response: Moving to home...]
Home position verified successfully

Step 2: Testing X-axis POSITIVE direction
  Testing X = +10 mm...
  Current position: X=10, Y=0, Z=100
  Testing X = +20 mm...
  Current position: X=20, Y=0, Z=100
  ...
  Testing X = +200 mm...
  LIMIT REACHED: X-axis positive limit detected at approximately +200 mm
  Setting safe positive limit to +190 mm
  Returning to home position...

Step 3: Testing X-axis NEGATIVE direction
  Testing X = -10 mm...
  Current position: X=-10, Y=0, Z=100
  ...

=== X-Axis Discovery Complete ===
Positive limit: +190 mm
Negative limit: -150 mm
Total X-axis range: 340 mm
End time: 2025-12-06T14:35:00-05:00
```

---

### Phase 2: Y-Axis Boundary Discovery

**Test Sequence:**

```bash
#!/bin/bash
# Y-Axis Workspace Discovery
# Generated: 2025-12-06 14:35:00
# Robot: XR-5000 on robotarm-pi

LOG_FILE="workspace-discovery-y-axis-$(date +%Y%m%d-%H%M%S).log"

echo "=== Y-Axis Workspace Discovery Started ===" | tee -a "$LOG_FILE"
echo "Start time: $(date -Iseconds)" | tee -a "$LOG_FILE"

# Return to home
ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"

# Positive Y direction
echo "Testing Y-axis POSITIVE direction" | tee -a "$LOG_FILE"
Y_POSITIVE_LIMIT=0
for distance in 10 20 50 100 150 200 250; do
  echo "  Testing Y = +$distance mm..." | tee -a "$LOG_FILE"

  ssh pi@robotarm-pi "robot-cli move y $distance" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    Y_POSITIVE_LIMIT=$((distance - 10))
    echo "  Y-axis positive limit: +$Y_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  Y_POSITIVE_LIMIT=$distance
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

# Negative Y direction
echo "Testing Y-axis NEGATIVE direction" | tee -a "$LOG_FILE"
Y_NEGATIVE_LIMIT=0
for distance in -10 -20 -50 -100 -150 -200; do
  echo "  Testing Y = $distance mm..." | tee -a "$LOG_FILE"

  ssh pi@robotarm-pi "robot-cli move y $distance" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    Y_NEGATIVE_LIMIT=$((distance + 10))
    echo "  Y-axis negative limit: $Y_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  Y_NEGATIVE_LIMIT=$distance
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

echo "=== Y-Axis Discovery Complete ===" | tee -a "$LOG_FILE"
echo "Positive limit: +$Y_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Negative limit: $Y_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Total Y-axis range: $((Y_POSITIVE_LIMIT - Y_NEGATIVE_LIMIT)) mm" | tee -a "$LOG_FILE"
```

---

### Phase 3: Z-Axis Boundary Discovery

**Note:** Z-axis testing is typically more critical as it affects collision with work surface.

```bash
#!/bin/bash
# Z-Axis Workspace Discovery
# Generated: 2025-12-06 14:40:00
# Robot: XR-5000 on robotarm-pi

LOG_FILE="workspace-discovery-z-axis-$(date +%Y%m%d-%H%M%S).log"

echo "=== Z-Axis Workspace Discovery Started ===" | tee -a "$LOG_FILE"
echo "Start time: $(date -Iseconds)" | tee -a "$LOG_FILE"

# WARNING: Z-axis downward testing requires extra caution
echo "WARNING: Testing Z-axis downward movement. Ensure work surface is clear!" | tee -a "$LOG_FILE"
echo "Press CTRL+C within 5 seconds to abort..."
sleep 5

ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"

# Test Z-axis UPWARD (positive) direction first (safer)
echo "Testing Z-axis UPWARD direction" | tee -a "$LOG_FILE"
Z_POSITIVE_LIMIT=0
for distance in 10 20 50 100 150 200; do
  echo "  Testing Z = +$distance mm (from home)..." | tee -a "$LOG_FILE"

  # Assuming home Z is 100, this tests upward
  target=$((100 + distance))
  ssh pi@robotarm-pi "robot-cli move z $target" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    Z_POSITIVE_LIMIT=$((target - 10))
    echo "  Z-axis upper limit: $Z_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  Z_POSITIVE_LIMIT=$target
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

# Test Z-axis DOWNWARD (negative) direction with CAUTION
echo "Testing Z-axis DOWNWARD direction (CAUTION: collision risk)" | tee -a "$LOG_FILE"
Z_NEGATIVE_LIMIT=100  # Start from home Z
for offset in 10 20 30 50 70 90; do
  target=$((100 - offset))
  echo "  Testing Z = $target mm (downward)..." | tee -a "$LOG_FILE"

  ssh pi@robotarm-pi "robot-cli move z $target" 2>&1 | tee -a "$LOG_FILE"

  if [ $? -ne 0 ]; then
    Z_NEGATIVE_LIMIT=$((target + 10))
    echo "  Z-axis lower limit: $Z_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"
    ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
    break
  fi

  Z_NEGATIVE_LIMIT=$target
  ssh pi@robotarm-pi "robot-cli home" 2>&1 | tee -a "$LOG_FILE"
done

echo "=== Z-Axis Discovery Complete ===" | tee -a "$LOG_FILE"
echo "Upper limit: $Z_POSITIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Lower limit: $Z_NEGATIVE_LIMIT mm" | tee -a "$LOG_FILE"
echo "Total Z-axis range: $((Z_POSITIVE_LIMIT - Z_NEGATIVE_LIMIT)) mm" | tee -a "$LOG_FILE"
```

---

### Generated Configuration File

After completing all three phases, the agent generates `workspace-config.yml`:

```yaml
# workspace-config.yml
# Robot Arm: XR-5000
# Raspberry Pi: robotarm-pi
# Generated: 2025-12-06T14:45:00-05:00
# Test duration: 15 minutes

workspace_limits:
  x_axis:
    min: -150  # mm, discovered via testing 2025-12-06
    max: 190   # mm, discovered via testing 2025-12-06
    safe_min: -140  # 10mm safety margin
    safe_max: 180   # 10mm safety margin
    total_range: 340  # mm

  y_axis:
    min: -100  # mm, discovered via testing 2025-12-06
    max: 150   # mm, discovered via testing 2025-12-06
    safe_min: -90   # 10mm safety margin
    safe_max: 140   # 10mm safety margin
    total_range: 250  # mm

  z_axis:
    min: 10    # mm, discovered via testing 2025-12-06 (10mm above work surface)
    max: 280   # mm, discovered via testing 2025-12-06
    safe_min: 20    # 10mm safety margin (avoid work surface collision)
    safe_max: 270   # 10mm safety margin
    total_range: 270  # mm

home_position:
  x: 0
  y: 0
  z: 100
  description: "Center position, safe for initialization"

safe_zones:
  - name: "primary_work_area"
    description: "Main operational zone with high confidence"
    x_range: [-120, 160]
    y_range: [-80, 130]
    z_range: [30, 250]
    confidence: high  # fully tested, multiple validations

  - name: "pick_zone_right"
    description: "Right-side object pickup area"
    x_range: [80, 160]
    y_range: [40, 100]
    z_range: [30, 80]
    confidence: high

  - name: "place_zone_left"
    description: "Left-side object placement area"
    x_range: [-120, -40]
    y_range: [50, 110]
    z_range: [30, 80]
    confidence: high

caution_zones:
  - name: "workspace_edge_positive_x"
    description: "Near positive X limit, use caution"
    x_range: [180, 190]
    y_range: [-100, 150]
    z_range: [10, 280]
    warning: "Close to X-axis limit, movements may be restricted"

  - name: "workspace_edge_negative_x"
    description: "Near negative X limit, use caution"
    x_range: [-150, -140]
    y_range: [-100, 150]
    z_range: [10, 280]
    warning: "Close to X-axis limit, movements may be restricted"

  - name: "near_work_surface"
    description: "Close to work surface, collision risk"
    x_range: [-150, 190]
    y_range: [-100, 150]
    z_range: [10, 25]
    warning: "Collision risk with work surface, verify clearance"

testing_metadata:
  test_date: "2025-12-06"
  test_time: "14:30:00 - 14:45:00"
  total_test_duration_minutes: 15
  robot_arm_model: "XR-5000"
  raspberry_pi_hostname: "robotarm-pi"
  tested_by: "agent-robotarm-tester v1.0.0"
  validation_status: "initial_discovery"
  notes: |
    Initial workspace boundary discovery completed successfully.
    All axes tested progressively with automatic limit detection.
    Safe zones defined with 10mm margins from absolute limits.
    Recommend periodic validation (quarterly) to detect any changes.

recommendations:
  - "Validate workspace boundaries quarterly or after any physical changes"
  - "Test safe zones with actual pick-and-place operations before production"
  - "Consider reducing safe_max values if experiencing limit errors in production"
  - "Add gripper offset calculations if end-effector extends beyond measured positions"
  - "Run repeatability test on home position to validate calibration"
  - "Document any physical obstacles within discovered workspace"
```

---

## Usage Instructions

**To execute this workflow:**

1. **Save each phase as a separate script:**
   - `x-axis-discovery.sh`
   - `y-axis-discovery.sh`
   - `z-axis-discovery.sh`

2. **Make scripts executable:**
   ```bash
   chmod +x *-discovery.sh
   ```

3. **Execute in order:**
   ```bash
   ./x-axis-discovery.sh
   ./y-axis-discovery.sh
   ./z-axis-discovery.sh
   ```

4. **Review logs** after each phase:
   ```bash
   cat workspace-discovery-x-axis-*.log
   cat workspace-discovery-y-axis-*.log
   cat workspace-discovery-z-axis-*.log
   ```

5. **Create configuration file** using discovered values

6. **Validate configuration** with small test movements within safe zones

---

## Safety Notes

- **Always monitor the first execution** - Be ready to press emergency stop
- **Start with X and Y axes** - Z-axis has collision risk with work surface
- **Clear workspace** - Remove all objects before testing
- **Verify home position** - Ensure robot can reliably return to home
- **Check logs immediately** - Review for any unexpected behavior
- **Update limits conservatively** - Use safety margins to account for variations

---

## Next Steps After Discovery

1. **Validate safe zones** - Test movements within defined safe zones
2. **Run repeatability test** - Verify home position consistency (Test Case 6)
3. **Benchmark performance** - Measure speed and accuracy (Test Cases 4 & 9)
4. **Test pick-and-place** - Validate operational sequences (Test Case 3)
5. **Document physical setup** - Record mounting, obstacles, workspace orientation
6. **Share configuration** - Distribute workspace-config.yml to team

---

**Example Generated By:** agent-robotarm-tester v1.0.0
**Date:** 2025-12-06
**Scenario:** Complete workspace boundary discovery for new robot arm setup
